"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80],{1917:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},2990:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3850:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},4080:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(3365),n=s(1521),l=s(6170),i=s(8600),o=s(7812),r=s(6009),c=s(1363),d=s(1917),m=s(6872),u=s(2990),h=s(3850),x=s(7882),f=s(7449),p=s(6555),g=s(2196);function y(e){let{position:t="bottom-right",theme:s="light",initialMessage:y,userId:w,userProfile:b,agentType:v="initial_customer"}=e,{t:j,locale:N,isRTL:k}=(0,c.h)(),[S,A]=(0,n.useState)(!1),[_,D]=(0,n.useState)(!1),[M,I]=(0,n.useState)([]),[C,H]=(0,n.useState)(""),[T,z]=(0,n.useState)(!1),[E,$]=(0,n.useState)(!0),[R,O]=(0,n.useState)(v),[P,L]=(0,n.useState)(!1),[q,Z]=(0,n.useState)(!1),[J,V]=(0,n.useState)(!0),[K,W]=(0,n.useState)(null),[B,F]=(0,n.useState)([]),[U,G]=(0,n.useState)(!1);(0,n.useRef)(null);let[Q,X]=(0,n.useState)(!1),[Y,ee]=(0,n.useState)(null),[et,es]=(0,n.useState)(b||null),[ea,en]=(0,n.useState)("initial_customer"===v),el=(0,n.useRef)(null),ei=(0,n.useRef)(null);(0,n.useEffect)(()=>{ei.current=window.speechSynthesis},[]),(0,n.useEffect)(()=>{0===M.length&&er()},[y,j]),(0,n.useEffect)(()=>{eo()},[M]);let eo=()=>{var e;null==(e=el.current)||e.scrollIntoView({behavior:"smooth"})},er=async()=>{try{let e=y||j("chatbot.initialMessage");if(et){let t=et.name||"valued customer",s=et.serviceHistory.length>0?"I see you've used our ".concat(et.serviceHistory.join(", ")," services before."):"";if(e="ar"===N?"مرحباً ".concat(t,"! ").concat(s," كيف يمكنني مساعدتك اليوم؟"):"Hello ".concat(t,"! ").concat(s," How can I help you today?"),et.conversationHistory.length>0)return void I(et.conversationHistory)}let t={id:"1",content:{initial_customer:"ar"===N?"مرحباً! أنا مساعدك لتسجيل العملاء الجدد. سأساعدك في جمع معلوماتك وربطك بالخدمة المناسبة.":"Hello! I'm your new customer onboarding assistant. I'll help collect your information and connect you with the right service.",n8n_workflow:"ar"===N?"مرحباً! أنا متخصص أتمتة سير العمل. يمكنني مساعدتك في إنشاء وإدارة سير العمل باستخدام n8n.":"Hello! I'm your workflow automation specialist. I can help you create and manage n8n workflows.",code_generation:"ar"===N?"مرحباً! أنا متخصص تطوير الوكلاء الأذكياء. سأساعدك في بناء حلول ذكاء اصطناعي مخصصة.":"Hello! I'm your AI agent development specialist. I'll help you build custom AI solutions.",consulting:"ar"===N?"مرحباً! أنا مستشار الذكاء الاصطناعي. يمكنني تقديم الاستشارات الاستراتيجية وجدولة جلسات مباشرة.":"Hello! I'm your AI consulting specialist. I can provide strategic guidance and schedule live sessions."}[v]||e,sender:"bot",timestamp:new Date,agentType:v};I([t]),J&&!q&&ec(t.content)}catch(e){console.error("Error loading user context:",e)}},ec=e=>{if(!J||!ei.current||q)return;let t=new SpeechSynthesisUtterance(e);t.lang="ar"===N?"ar-SA":"en-US",t.rate=.9,t.pitch=1,t.onstart=()=>Z(!0),t.onend=()=>Z(!1),t.onerror=()=>Z(!1),ei.current.speak(t)},ed=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(!e.trim())return;let s=(e=>{if(!ea)return{allowed:!0};if(M.filter(e=>"user"===e.sender&&Date.now()-e.timestamp.getTime()<6e4).length>10)return{allowed:!1,reason:"Rate limit exceeded. Please wait a moment."};for(let t of[/hack|exploit|vulnerability|injection|script/i,/(.)\1{10,}/,/^\s*$/])if(t.test(e))return{allowed:!1,reason:"Message contains inappropriate content."};return e.length>1e3?{allowed:!1,reason:"Message too long. Please keep it under 1000 characters."}:{allowed:!0}})(e);if(!s.allowed){let e={id:Date.now().toString(),content:s.reason||"Message blocked by security filters.",sender:"bot",timestamp:new Date,type:"guardrail"};I(t=>[...t,e]);return}let a={id:Date.now().toString(),content:e,sender:"user",timestamp:new Date,type:t};if(I(e=>[...e,a]),H(""),z(!0),et){let e={...et,conversationHistory:[...M,a]};es(e),localStorage.setItem("user_profile_".concat(w),JSON.stringify(e))}try{let s=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,customer_id:w||"anonymous",context:{session_id:"chat-".concat(w,"-").concat(Date.now()),language:N,timestamp:new Date().toISOString(),use_real_llm:!0,agent_type:R,user_profile:et,message_type:t,guardrails_active:ea}})}),n=await s.json();setTimeout(()=>{var e,t,s;let l={id:(Date.now()+1).toString(),content:(null==(e=n.response)?void 0:e.message)||n.response||j("chatbot.defaultResponse")||"I understand you're interested in our AI services. Let me help you with that!",sender:"bot",timestamp:new Date,type:(null==(t=n.response)?void 0:t.type)||"text",agentType:(null==(s=n.response)?void 0:s.agent_type)||R};if(I(e=>[...e,l]),z(!1),J&&!q&&ec(l.content),em(n.response,l),et){let e={...et,conversationHistory:[...M,a,l]};es(e),localStorage.setItem("user_profile_".concat(w),JSON.stringify(e))}},1500)}catch(t){z(!1);let e={id:(Date.now()+1).toString(),content:j("chatbot.errorMessage")||"Sorry, I encountered an error. Please try again.",sender:"bot",timestamp:new Date};I(t=>[...t,e])}},em=(e,t)=>{if(e){if((e.handoff_required||"human_handoff"===e.next_action)&&setTimeout(()=>{let e={id:(Date.now()+2).toString(),content:j("chatbot.handoffMessage")||"Let me connect you with a human specialist.",sender:"bot",timestamp:new Date,type:"handoff"};I(t=>[...t,e])},1e3),e.live_session_required&&"consulting"===R&&eu(),e.code_generated&&"code_generation"===R){let t={id:(Date.now()+3).toString(),content:e.code_content||"Here's your generated code:",sender:"bot",timestamp:new Date,type:"code",codeLanguage:e.code_language||"python"};setTimeout(()=>{I(e=>[...e,t])},2e3)}if(e.workflow_created&&"n8n_workflow"===R){let t={id:(Date.now()+4).toString(),content:'Workflow "'.concat(e.workflow_name,'" has been created successfully!'),sender:"bot",timestamp:new Date,type:"action"};setTimeout(()=>{I(e=>[...e,t])},2e3)}}},eu=async()=>{try{let e=await fetch("/api/live-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:w,agent_type:R,session_type:"video_consultation"})});if(e.ok){let{session_id:t,join_url:s}=await e.json();ee(t),X(!0);let a={id:Date.now().toString(),content:"Live session initiated! Session ID: ".concat(t),sender:"bot",timestamp:new Date,type:"action"};I(e=>[...e,a])}}catch(e){console.error("Error initiating live session:",e)}},eh=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ed(C))},ex=()=>{let e={id:Date.now().toString(),content:j("chatbot.talkToHuman"),sender:"user",timestamp:new Date};I(t=>[...t,e]),setTimeout(()=>{let e={id:(Date.now()+1).toString(),content:j("chatbot.connectingMessage"),sender:"bot",timestamp:new Date,type:"handoff"};I(t=>[...t,e]),console.log("Handoff requested - initiating live session with Root Agent")},1e3)},ef=()=>{let e={id:Date.now().toString(),content:j("chatbot.scheduleCall"),sender:"user",timestamp:new Date};I(t=>[...t,e]),setTimeout(()=>{let e={id:(Date.now()+1).toString(),content:j("chatbot.scheduleMessage"),sender:"bot",timestamp:new Date,type:"action"};I(t=>[...t,e])},1e3)},ep=e=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return"embedded"===t?(0,a.jsxs)(l.Zp,{className:"w-full h-[600px] flex flex-col",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)(l.ZB,{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("span",{children:j("chatbot.title")})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(r.E,{variant:E?"default":"destructive",className:"text-xs",children:E?j("chatbot.online"):j("chatbot.offline")})})]}),(0,a.jsxs)(l.Wu,{className:"flex-1 flex flex-col p-0",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[M.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[80%] rounded-lg p-3 shadow-sm ".concat("user"===e.sender?"bg-blue-600 text-white":"bg-white text-gray-800 border border-gray-200"),children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:["bot"===e.sender&&(0,a.jsx)(d.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:e.content}),(0,a.jsx)("p",{className:"text-xs mt-1 ".concat("user"===e.sender?"text-blue-100":"text-gray-500"),children:ep(e.timestamp)})]})]}),"handoff"===e.type&&(0,a.jsx)("div",{className:"mt-3 space-y-2",children:(0,a.jsxs)(i.$,{size:"sm",variant:"outline",className:"w-full",onClick:ex,children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),j("chatbot.connectNow")]})}),"action"===e.type&&e.content.includes("schedule")&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsxs)(i.$,{size:"sm",variant:"outline",className:"w-full",onClick:ef,children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Schedule Now"]})})]})},e.id)),T&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 max-w-[80%] shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),(0,a.jsx)("div",{ref:el})]}),(0,a.jsxs)("div",{className:"border-t p-4",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(o.p,{value:C,onChange:e=>H(e.target.value),onKeyPress:eh,placeholder:j("chatbot.placeholder"),className:"flex-1"}),(0,a.jsx)(i.$,{onClick:()=>ed(C),disabled:!C.trim()||T,children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:ex,children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),j("chatbot.talkToHuman")]}),(0,a.jsxs)(i.$,{variant:"outline",size:"sm",onClick:ef,children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),j("chatbot.scheduleCall")]})]})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[!S&&(0,a.jsx)("div",{className:"fixed ".concat("bottom-right"===t?"bottom-6 right-6":"bottom-6 left-6"," z-50"),children:(0,a.jsx)(i.$,{onClick:()=>{console.log("Chatbot toggle clicked, current state:",S),A(!S),S||0!==M.length||er()},className:"rounded-full w-16 h-16 shadow-lg hover:shadow-xl transition-shadow text-lg",size:"lg",children:(0,a.jsx)(x.A,{className:"h-8 w-8"})})}),S&&(0,a.jsx)("div",{className:"fixed ".concat("bottom-right"===t?"bottom-6 right-6":"bottom-6 left-6"," z-50"),children:(0,a.jsxs)(l.Zp,{className:"w-96 ".concat(_?"h-14":"h-[500px]"," shadow-xl transition-all duration-300"),children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)(l.ZB,{className:"flex items-center space-x-2 text-sm",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{children:j("chatbot.title")}),(0,a.jsx)(r.E,{variant:E?"default":"destructive",className:"text-xs",children:E?j("chatbot.online"):j("chatbot.offline")})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>D(!_),className:"h-6 w-6 p-0",children:_?(0,a.jsx)(f.A,{className:"h-3 w-3"}):(0,a.jsx)(p.A,{className:"h-3 w-3"})}),(0,a.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>A(!1),className:"h-6 w-6 p-0",children:(0,a.jsx)(g.A,{className:"h-3 w-3"})})]})]}),!_&&(0,a.jsxs)(l.Wu,{className:"flex flex-col h-[440px] p-0",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[M.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[85%] rounded-lg p-3 shadow-sm ".concat("user"===e.sender?"bg-blue-600 text-white":"bg-white text-gray-800 border border-gray-200"),children:[(0,a.jsxs)("div",{className:"flex items-start space-x-1",children:["bot"===e.sender&&(0,a.jsx)(d.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:e.content}),(0,a.jsx)("p",{className:"text-xs mt-1 ".concat("user"===e.sender?"text-blue-100":"text-gray-500"),children:ep(e.timestamp)})]})]}),"handoff"===e.type&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)(i.$,{size:"sm",variant:"outline",className:"w-full text-xs h-6",onClick:ex,children:[(0,a.jsx)(m.A,{className:"h-3 w-3 mr-1"}),j("chatbot.connectNow")]})})]})},e.id)),T&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-2 max-w-[85%] shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(d.A,{className:"h-3 w-3 text-blue-600"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-1 h-1 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),(0,a.jsx)("div",{ref:el})]}),(0,a.jsx)("div",{className:"border-t p-2",children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)(o.p,{value:C,onChange:e=>H(e.target.value),onKeyPress:eh,placeholder:j("chatbot.placeholder"),className:"flex-1 text-sm h-8"}),(0,a.jsx)(i.$,{onClick:()=>ed(C),disabled:!C.trim()||T,size:"sm",className:"h-8 w-8 p-0",children:(0,a.jsx)(h.A,{className:"h-3 w-3"})})]})})]})]})})]})}},6009:(e,t,s)=>{s.d(t,{E:()=>o});var a=s(3365);s(1521);var n=s(2934),l=s(9671);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{className:(0,l.cn)(i({variant:s}),t),...n})}},6555:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]])},6872:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},7449:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]])},7812:(e,t,s)=>{s.d(t,{p:()=>i});var a=s(3365),n=s(1521),l=s(9671);let i=n.forwardRef((e,t)=>{let{className:s,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},7882:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(7982).A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])}}]);